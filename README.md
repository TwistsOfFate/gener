# Gener: 染色体变异检测

[toc]

## 1 数据分析

0k-1k:  534     0.069486
1k-2k:  2292    0.298243
2k-3k:  2023    0.26324
3k-4k:  1301    0.169291
4k-5k:  680     0.0884841
5k-6k:  389     0.0506181
6k-7k:  215     0.0279766
7k-8k:  128     0.0166558
8k-9k:  79      0.0102798
9k-10k: 44      0.00572544
Total lines: 768



- 从ref.fasta的序列中截取子片段 $base\_excerpt$，在long.fasta中扫描各个测序数据段是否包含 $base\_excerpt$：
  - 太慢
    - 对字符串进行哈希，提高匹配速度
  - 即使子片段 $base\_excerpt$ 选得很长，仍无法避免同一 $base\_excerpt$ 在不同染色体的测序数据段出现：
    - 经过比对，发现不同的染色体上确实存在着相同的片段，而不是碰巧相同，说明这一方法还是有效的。
- 根据long.fasta中各个测序数据段在ref.fasta中匹配的位置，确定它们之间大致的相对位置关系，然后进行拼接还原成完整的变异染色体。拼接时寻找在多个位置相近的测序段 $L=\{l_1, l_2, ...\}$ 中同时出现的短序列 $s$，认为这个短序列 $s$ 是正确的。以 $s$ 为基础向两端扩展，以向右扩展为例：对于 $L$ 中每个测序段 $l_i$ ，检查其在 $s$ 右侧的短序列 $t_i$ 是否也在某几个位置相近的测序段 $L'$ 中出现，记出现的次数为 $n_i$。取 $n_i$ 最大的 $t_i$ 认为该短序列是正确的，并将 $L$ 更新为 $L'$，以此不断重复直至拓展至完整的序列。
  - 需要限制 $max\{n_i\}$ 的值，但其中的度不好把握：
    - 如果偏小：可能这 $n_i$ 个测序段同时错了，由此得到错误的短序列 $t_i$
    - 如果偏大：得不到包含足够多测序段的集合 $L$，进而在下一轮生成中，正确的短序列 $t$ 根本未被包含在 $L$ 中
  - 实现相对复杂
- 

